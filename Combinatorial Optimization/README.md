   # Finding the Fantasy Team
**Group 7: Liam A., Jashan B., James W., Yao W.**  
**March 2025**

---

## Introduction

The National Basketball Association, known as the NBA, is the most watched basketball league in the world, with millions of fans tuning in to support their favourite teams every season. One of the most common conversations among fans is who they would like to add to their team if they were the general manager. Lots of fans will often feel they can run their team much better and win a championship. We set out to try and answer that question of which players to choose as a GM to make the best team in the NBA. We did this with the help of combinatorial optimization by framing roster choice as a 0-1 packing problem. 
As expected, there were multiple challenges because defining what numerically makes a team great is one of the biggest unsolved questions in sports analysis. We ended up having three distinct metrics for the value of a player and thus three different objective functions. 
The weakest team was generated from maximizing the roster’s Net Rating (Offensive Rating – Defensive Rating). The second best and possibly most realistic team from the perspective of a General Manager in the NBA was generated by maximizing the player efficiency rating (PER). Lastly, the best team was generated from minimizing each player's distance from the league leaders with respect to their individual stats. This team was deemed too overpowered, and the trades to acquire it would likely be infeasible due to the high value of each player. If the trades were somehow possible, they would likely be vetoed by the commissioner of the NBA as done in the past to block certain players from teaming up.

---

## Mathematical Tools and Theory

### A Twist of the Knapsack Problem

The problem at hand is a twist on the classic knapsack problem.

```math
\text{max } \sum_i v_i x_i
```

```math
\text{subject to}
```

```math
\sum_i w_i x_i \le C
```

Where $v_i$ is the value of item $i$, $x_i$ indicates whether item $i$ is chosen or not, $w_i$ is the weight of item $i$ and $C$ is the maximum weight that the knapsack can hold.\\

Instead of packing the most valuable items in the knapsack, the optimal NBA team would amalgamate players to build the best performing team. Team performance has to be quantified by some metric. In this project, team performance was chosen to be quantified three different ways:

1. The net rating: player offensive rating − player defensive rating  
2. The total efficiency rating  
3. The "distance" from leading statistics  

The salary of each player would be the individual weights in the knapsack problem and the budget a team manager has for purchasing the team would be the maximum capacity the knapsack can hold. The problem aims at choosing the best performing players within the league maximum NBA operating budget.

---

### Additional Constraints

Aside from the salary cap that a team has, there are additional constraints to comply with game technicalities as well as ensuring that players are not only affordable but have high performing statistics.

One constraint would be roster size. There can only be so many players and spares on a team. There has to be at least one of each position as well so that the algorithm doesn't only select players that main one position.

Another constraint would be average performance statistics. To select an optimal team, there has to be a benchmark to quantify how good the selected players are. Otherwise, the algorithm might choose players purely based on salary and not consider performance.

---

## Definitions and Notation

In general, the problems will be modelled as a twist of the classical knapsack problem:

```math
\text{max } \sum_i v_i x_i
```

```math
\text{subject to}
```

```math
\sum_i w_i x_i \le C
```

```math
\mathbf{A}x \ge b
```

For the programs formulated, these are some key variables that will be used:

- $v_i$ represents the quantified value that player $i$ brings.  
- $x_i$ is the decision variable (0 or 1).  
- $\mathbf{A}$ is a matrix of statistical measures.  
- $b_i$ is the minimum statistical requirement for each stat.  
- $w_i$ represents each player's salary.  
- $\alpha$ represents a varying scalar applied to offensive rating.  
- $\beta$ represents a varying scalar applied to defensive rating.  

$\alpha$ and $\beta$ are parameters in the objective function to adjust weights of offensive and defensive rating.

---

## Modelling Process

### Preprocessing the Data

All data collection was done through  
`[cite: data]` for the player stats. The stats collected were: PTS, REB, AST, STL, BLK, ORTG, DRTG, WS.

Players who played fewer than 58 games or fewer than 5 minutes per game were removed. This reduced the dataset from 537 players to 245 players.

We then collected data from the last 20 championship rosters (2003–2023) to compute ideal stat thresholds:

- **110.8 Points**  
- **25.3 Assists**  
- **45.6 Rebounds**  
- **8.5 Steals**  
- **5.8 Blocks**

These thresholds ensured our chosen rosters remained balanced and realistic.

---

### Setting Up the Model

All three models share the same constraints:

```math
\text{Maximize } (v^T x)
```

```math
a_{11}x_1 + \dots + a_{1n}x_n \ge 110.8 \text{ Points}
```

```math
a_{21}x_1 + \dots + a_{2n}x_n \ge 25.3 \text{ Assists}
```

```math
a_{31}x_1 + \dots + a_{3n}x_n \ge 45.6 \text{ Rebounds}
```

```math
a_{41}x_1 + \dots + a_{4n}x_n \ge 8.5 \text{ Steals}
```

```math
a_{51}x_1 + \dots + a_{5n}x_n \ge 5.8 \text{ Blocks}
```

```math
a_{61}x_1 + \dots + a_{6n}x_n \le 136{,}021{,}000 \text{ Salary Cap}
```

```math
x_i \in \{0,1\}
```

Roster constraints:

- At least **14 players**  
- At most **15 players**  
- At least **2 players per position**  

### Player positions

![Player positions](photos/player_pos.png)

---

## Approach 1: Maximize Net Rating (ORTG − DRTG)

Offensive and Defensive Ratings are advanced metrics developed by Dean Oliver.

Objective:

```math
\text{Max } (\textbf{Net Rating})^T x
```

with constraints $A x \ge b$.

This approach produced the following roster:

![Net Rating Results](photos/net_rating.png)

---

## Approach 2: Maximize Player Efficiency Rating (PER)

PER is computed as:

```math
\sum (\text{Positive Contributions}) - (\text{Negative Contributions})
```

Objective:

```math
\text{Max } (\textbf{PER})^T x
```

This approach produced the following roster:

![PER Results](photos/per.png)

---

## Approach 3: Minimize Distance to Best in the League

League leaders:

- PTS: 33.1 (Embiid)
- REB: 12.3 (Sabonis)
- AST: 10.7 (Harden)
- WS: 14.9 (Jokic)

Objective:

```math
\text{Min } \left( |33.1 - PTS| + |12.3 - REB| + |10.7 - AST| + |14.9 - WS| \right)^T x
```

This produced the strongest (but unrealistic) roster:

![Selected Players](photos/table%20of%20selected.png)
![Scatter Plot](photos/scatter%20plot%20of%20selected.png)

---

## Comparison of Selected vs Non-selected Players

Scatter plot examples:

![Points vs Salary](photos/1.png)
![Defensive Rating vs Salary](photos/2.png)

![Assists vs Salary](photos/3.png)
![Offensive Rating vs Salary](photos/4.png)

![Steals vs Salary](photos/5.png)

Average stats comparison:

![Ratings](photos/8.png)
![More stats](photos/7.png)

---

## Conclusion and Future Considerations

Overall, the league-leaders (Approach 3) team is unrealistic due to contract restrictions, despite being statistically optimal.

Between the Net Rating team and PER team, the choice is subjective. The Net Rating team resembles real NBA construction more closely, while the PER team contains four All-Stars, which is less common historically.

---

## Future Considerations

Basketball defense is difficult to quantify because steals and blocks are rare. Future improvements may include:

- Using more stats (e.g., shot percentage, attempts, 3PT shooting)  
- Using machine learning to create new player-value metrics  
- Including chemistry-based objective functions depending on combinations of playstyles  

---

## References

(Your bibliography would render here using `biblatex`—Markdown cannot auto-generate a bibliography.)

